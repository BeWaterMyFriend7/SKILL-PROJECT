<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>功能测试页面</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>功能测试</h1>
    
    <div class="test-section">
        <h2>1. 数据加载测试</h2>
        <div id="dataTest">正在测试...</div>
    </div>
    
    <div class="test-section">
        <h2>2. 本地存储测试</h2>
        <div id="storageTest">正在测试...</div>
    </div>
    
    <div class="test-section">
        <h2>3. 页面跳转测试</h2>
        <button onclick="testDetailPage()">测试详情页面 (ID=1)</button>
        <div id="jumpTest">点击按钮测试</div>
    </div>

    <script>
        // 测试数据加载
        async function testDataLoading() {
            try {
                const response = await fetch('software-data.txt');
                const data = await response.text();
                const softwareData = JSON.parse(data);
                document.getElementById('dataTest').innerHTML = 
                    `<span class="success">✓ 数据加载成功，共 ${softwareData.length} 个软件</span>`;
                return softwareData;
            } catch (error) {
                document.getElementById('dataTest').innerHTML = 
                    `<span class="error">✗ 数据加载失败: ${error.message}</span>`;
                return null;
            }
        }

        // 测试本地存储
        function testLocalStorage() {
            try {
                const testData = { test: 'hello', timestamp: Date.now() };
                localStorage.setItem('test', JSON.stringify(testData));
                const retrieved = JSON.parse(localStorage.getItem('test'));
                localStorage.removeItem('test');
                
                if (retrieved && retrieved.test === 'hello') {
                    document.getElementById('storageTest').innerHTML = 
                        `<span class="success">✓ 本地存储功能正常</span>`;
                } else {
                    throw new Error('存储数据不匹配');
                }
            } catch (error) {
                document.getElementById('storageTest').innerHTML = 
                    `<span class="error">✗ 本地存储失败: ${error.message}</span>`;
            }
        }

        // 测试页面跳转
        function testDetailPage() {
            document.getElementById('jumpTest').innerHTML = 
                '<a href="detail.html?id=1" target="_blank">点击这里测试详情页面</a>';
        }

        // 页面加载时运行测试
        window.addEventListener('DOMContentLoaded', function() {
            testDataLoading();
            testLocalStorage();
        });
    </script>
</body>
</html>